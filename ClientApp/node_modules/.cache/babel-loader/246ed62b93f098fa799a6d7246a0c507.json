{"ast":null,"code":"var _jsxFileName = \"/home/abdisalam/Downloads/BMSytem/ClientApp/src/views/User/Profile.jsx\";\nimport React, { Component } from \"react\";\nimport Services from \"../../services/HttpServices\";\nimport jwtDecode from \"jwt-decode\";\nimport { Card } from \"react-bootstrap\";\nimport joi from \"joi-browser\";\nimport { toast } from \"react-toastify\";\nimport Config from \"../../config/config.json\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nclass Profile extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      user: {\n        id: 0,\n        name: \"\",\n        username: \"\",\n        role: \"\",\n        password: \"\"\n      },\n      errors: {}\n    };\n    this.schema = {\n      id: joi.number().allow(0),\n      name: joi.string().min(3).required().label(\"Name\"),\n      username: joi.string().required().label(\"Username\"),\n      role: joi.string().required().label(\"Role\"),\n      password: joi.string().required().label(\"Password\"),\n      status: joi.any(),\n      notar: joi.any(),\n      notary: joi.any(),\n      notarId: joi.any()\n    };\n\n    this.validateProperty = input => {\n      const obj = {\n        [input.name]: input.value\n      };\n      const schem = {\n        [input.name]: this.schema[input.name]\n      };\n      const {\n        error\n      } = joi.validate(obj, schem);\n      if (!error) return null;\n      return error.details[0].message;\n    };\n\n    this.validate = () => {\n      const user = { ...this.state.user\n      };\n      const errors = {};\n      const option = {\n        abortEarly: false\n      };\n      const {\n        error\n      } = joi.validate(user, this.schema, option);\n      if (!error) return null;\n\n      for (let e of error.details) errors[e.path[0]] = e.message;\n\n      return errors;\n    };\n\n    this.handleSubmit = e => {\n      e.preventDefault();\n      const user = { ...this.state.user\n      };\n      const errors = this.validate();\n      this.setState({\n        errors: errors || {}\n      });\n      const auth = {\n        Authorization: `bearer ${localStorage[\"token\"]}`\n      };\n      if (errors) return;\n      this.setState({\n        loading: true\n      });\n      Services.put(Config.apiUrl + \"/users/\" + user.id, user, {\n        headers: auth\n      }).then(() => {\n        Services.post(Config.apiUrl + \"/token\", user).then(({\n          data\n        }) => {\n          localStorage.setItem(\"token\", data.token);\n          window.location = \"/\";\n        }).catch(error => {\n          if (error.response.status === 400 && error.response.data) {\n            const errors = { ...this.state.errors\n            };\n            errors[\"username\"] = error.response.data;\n            this.setState({\n              errors,\n              loading: false\n            });\n          }\n        });\n      }).catch(() => {\n        toast.error(\"Something went wrong.\");\n      });\n    };\n\n    this.handleChange = ({\n      currentTarget: input\n    }) => {\n      const user = { ...this.state.user\n      };\n      user[input.name] = input.value;\n      const errors = { ...this.state.errors\n      };\n      const errorMessage = this.validateProperty(input);\n      if (errorMessage) errors[input.name] = errorMessage;else delete errors[input.name];\n      this.setState({\n        user,\n        errors\n      });\n    };\n  }\n\n  render() {\n    const {\n      user,\n      errors\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(Card, {\n        children: [/*#__PURE__*/_jsxDEV(Card.Header, {\n          children: /*#__PURE__*/_jsxDEV(Card.Title, {\n            children: \"Profile\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 40,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 39,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: this.handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(Card.Body, {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"row form-group\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-12\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"name\",\n                  children: \"Name\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 46,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  onChange: this.handleChange,\n                  value: user.name,\n                  id: \"name\",\n                  name: \"name\",\n                  type: \"text\",\n                  className: \"form-control\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 47,\n                  columnNumber: 19\n                }, this), errors[\"name\"] && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-danger\",\n                  children: errors[\"name\"]\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 56,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 45,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 44,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"row form-group\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"username\",\n                  children: \"Username\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 62,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  id: \"username\",\n                  name: \"username\",\n                  value: user.username,\n                  disabled: true,\n                  type: \"text\",\n                  className: \"form-control\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 63,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 61,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"role\",\n                  children: \"Role\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 73,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  id: \"role\",\n                  name: \"role\",\n                  value: user.role,\n                  disabled: true,\n                  type: \"text\",\n                  className: \"form-control\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 74,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 72,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 60,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 43,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Card.Footer, {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                className: \"btn btn-primary\",\n                disabled: this.validate(),\n                children: \"Save changes\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 87,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 86,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 42,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 9\n      }, this)\n    }, void 0, false);\n  }\n\n  componentDidMount() {\n    const token = localStorage.getItem(\"token\");\n    const currentUser = jwtDecode(token);\n    this.setState({\n      loading: true\n    });\n    const auth = {\n      Authorization: `bearer ${localStorage[\"token\"]}`\n    };\n    Services.get(Config.apiUrl + \"/users/\" + currentUser.id, {\n      headers: auth\n    }).then(({\n      data\n    }) => {\n      this.setState({\n        user: data,\n        loading: false\n      });\n    }).catch(error => {\n      console.log(error);\n      toast.error(\"Something went wrong\");\n    });\n  }\n\n}\n\nexport default Profile;","map":{"version":3,"sources":["/home/abdisalam/Downloads/BMSytem/ClientApp/src/views/User/Profile.jsx"],"names":["React","Component","Services","jwtDecode","Card","joi","toast","Config","Profile","state","user","id","name","username","role","password","errors","schema","number","allow","string","min","required","label","status","any","notar","notary","notarId","validateProperty","input","obj","value","schem","error","validate","details","message","option","abortEarly","e","path","handleSubmit","preventDefault","setState","auth","Authorization","localStorage","loading","put","apiUrl","headers","then","post","data","setItem","token","window","location","catch","response","handleChange","currentTarget","errorMessage","render","componentDidMount","getItem","currentUser","get","console","log"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Services from \"../../services/HttpServices\";\nimport jwtDecode from \"jwt-decode\";\nimport { Card } from \"react-bootstrap\";\nimport joi from \"joi-browser\";\nimport { toast } from \"react-toastify\";\nimport Config from \"../../config/config.json\";\n\nclass Profile extends Component {\n  state = {\n    user: {\n      id: 0,\n      name: \"\",\n      username: \"\",\n      role: \"\",\n      password: \"\",\n    },\n    errors: {},\n  };\n\n  schema = {\n    id: joi.number().allow(0),\n    name: joi.string().min(3).required().label(\"Name\"),\n    username: joi.string().required().label(\"Username\"),\n    role: joi.string().required().label(\"Role\"),\n    password: joi.string().required().label(\"Password\"),\n    status: joi.any(),\n    notar: joi.any(),\n    notary: joi.any(),\n    notarId: joi.any(),\n  };\n\n  render() {\n    const { user, errors } = this.state;\n\n    return (\n      <>\n        <Card>\n          <Card.Header>\n            <Card.Title>Profile</Card.Title>\n          </Card.Header>\n          <form onSubmit={this.handleSubmit}>\n            <Card.Body>\n              <div className=\"row form-group\">\n                <div className=\"col-12\">\n                  <label htmlFor=\"name\">Name</label>\n                  <input\n                    onChange={this.handleChange}\n                    value={user.name}\n                    id=\"name\"\n                    name=\"name\"\n                    type=\"text\"\n                    className=\"form-control\"\n                  />\n                  {errors[\"name\"] && (\n                    <div className=\"text-danger\">{errors[\"name\"]}</div>\n                  )}\n                </div>\n              </div>\n              <div className=\"row form-group\">\n                <div className=\"col-6\">\n                  <label htmlFor=\"username\">Username</label>\n                  <input\n                    id=\"username\"\n                    name=\"username\"\n                    value={user.username}\n                    disabled={true}\n                    type=\"text\"\n                    className=\"form-control\"\n                  />\n                </div>\n                <div className=\"col-6\">\n                  <label htmlFor=\"role\">Role</label>\n                  <input\n                    id=\"role\"\n                    name=\"role\"\n                    value={user.role}\n                    disabled={true}\n                    type=\"text\"\n                    className=\"form-control\"\n                  />\n                </div>\n              </div>\n            </Card.Body>\n            <Card.Footer>\n              <div className=\"text-center\">\n                <button\n                  type=\"submit\"\n                  className=\"btn btn-primary\"\n                  disabled={this.validate()}\n                >\n                  Save changes\n                </button>\n              </div>\n            </Card.Footer>\n          </form>\n        </Card>\n      </>\n    );\n  }\n\n  componentDidMount() {\n    const token = localStorage.getItem(\"token\");\n    const currentUser = jwtDecode(token);\n    this.setState({ loading: true });\n    const auth = { Authorization: `bearer ${localStorage[\"token\"]}` };\n\n    Services.get(Config.apiUrl + \"/users/\" + currentUser.id, { headers: auth })\n      .then(({ data }) => {\n        this.setState({ user: data, loading: false });\n      })\n      .catch((error) => {\n        console.log(error);\n        toast.error(\"Something went wrong\");\n      });\n  }\n  validateProperty = (input) => {\n    const obj = { [input.name]: input.value };\n    const schem = { [input.name]: this.schema[input.name] };\n    const { error } = joi.validate(obj, schem);\n\n    if (!error) return null;\n\n    return error.details[0].message;\n  };\n  validate = () => {\n    const user = { ...this.state.user };\n    const errors = {};\n    const option = { abortEarly: false };\n    const { error } = joi.validate(user, this.schema, option);\n\n    if (!error) return null;\n\n    for (let e of error.details) errors[e.path[0]] = e.message;\n\n    return errors;\n  };\n  handleSubmit = (e) => {\n    e.preventDefault();\n\n    const user = { ...this.state.user };\n    const errors = this.validate();\n    this.setState({ errors: errors || {} });\n    const auth = { Authorization: `bearer ${localStorage[\"token\"]}` };\n\n    if (errors) return;\n\n    this.setState({ loading: true });\n\n    Services.put(Config.apiUrl + \"/users/\" + user.id, user, { headers: auth })\n      .then(() => {\n        Services.post(Config.apiUrl + \"/token\", user)\n          .then(({ data }) => {\n            localStorage.setItem(\"token\", data.token);\n            window.location = \"/\";\n          })\n          .catch((error) => {\n            if (error.response.status === 400 && error.response.data) {\n              const errors = { ...this.state.errors };\n              errors[\"username\"] = error.response.data;\n\n              this.setState({ errors, loading: false });\n            }\n          });\n      })\n      .catch(() => {\n        toast.error(\"Something went wrong.\");\n      });\n  };\n  handleChange = ({ currentTarget: input }) => {\n    const user = { ...this.state.user };\n    user[input.name] = input.value;\n    const errors = { ...this.state.errors };\n    const errorMessage = this.validateProperty(input);\n\n    if (errorMessage) errors[input.name] = errorMessage;\n    else delete errors[input.name];\n\n    this.setState({ user, errors });\n  };\n}\n\nexport default Profile;\n"]},"metadata":{},"sourceType":"module"}